%
% 个人自用文档样式
%

\ProvidesPackage{morelull}[2023/06/18 v0.4.0]

% 中文标点符号
\RequirePackage{xeCJKfntef}
% 眉首眉脚
\RequirePackage{fancyhdr}
% 颜色支持
\RequirePackage[table, dvipsnames]{xcolor}
% 代码提示
\RequirePackage{listings}
% 版边边距
\RequirePackage[left=2cm, right=2cm, bottom=2cm, headheight=14pt]{geometry}
% 更加现代定理、引用提示
\RequirePackage{tcolorbox}
% 书签
\RequirePackage[open, openlevel=2, atend]{bookmark}
% 链接
\RequirePackage{hyperref}

%%% 颜色定义 %%%
% 水
\providecolor{水蓝}{HTML}{d2f0f4}

% 蓝
\providecolor{云山蓝}{HTML}{2f90b9}
\providecolor{月白}{HTML}{eef7f2}

\providecolor{靛蓝}{HTML}{065279}
\providecolor{靛青}{HTML}{177cb0}

% 红
\providecolor{藏花红}{HTML}{ec2d7a}
\providecolor{海棠红}{HTML}{f03752}
\providecolor{桃红}{HTML}{f47983}
\providecolor{品红}{HTML}{f00056}
\providecolor{丹}{HTML}{ff4e20}
\providecolor{芙蓉红}{HTML}{f9723d}
\providecolor{莓酱红}{HTML}{fa5d19}

% 绿
\providecolor{粉绿}{HTML}{83cbac}
\providecolor{美蝶绿}{HTML}{12aa9c}
\providecolor{绿沈}{HTML}{0c8918}
\providecolor{青碧}{HTML}{48c0a3}
\providecolor{缥}{HTML}{7fecad}
\providecolor{艾绿}{HTML}{a4e2c6}
\providecolor{嫩绿}{HTML}{bddd22}
\providecolor{青白}{HTML}{c0ebd7}
% 黄
\providecolor{姜黄}{HTML}{ffc773}
\providecolor{橙色}{HTML}{fa8c35}
% 灰
\providecolor{苍白}{HTML}{d1d9e0}
\providecolor{苍青}{HTML}{7397ab}
% 黑
\providecolor{漆黑}{HTML}{161823}
\providecolor{墨色}{HTML}{50616d}
% 白
\providecolor{莹白}{HTML}{e3f9fd}
\providecolor{雪白}{HTML}{f2fdff}
\providecolor{月白}{HTML}{d6ecf0}
\providecolor{花白}{HTML}{c2ccd0}
\providecolor{灰白}{HTML}{f0f0f4}

% 紫
\providecolor{青蛤壳紫}{HTML}{bc84a8}
\providecolor{豆蔻紫}{HTML}{ad6598}

%% 字体颜色 %%
\colorlet{正文字色}{漆黑}
\colorlet{主色}{云山蓝}
\colorlet{次主色}{月白}
\colorlet{乙色}{粉绿}
\colorlet{重乙色}{美蝶绿}
\colorlet{丙色}{芙蓉红}
\colorlet{重丙色}{莓酱红}
\colorlet{丁色}{青蛤壳紫}
\colorlet{重丁色}{豆蔻紫}

\colorlet{亮色}{藏花红}
\colorlet{次亮色}{海棠红}

%%% CTEX格式设置 %%%
\ctexset{
  today=big,
  contentsname={文章导航},
  section/format=\Large\bfseries\centering\color{主色},
  subsection/number={\textcolor{主色}{\thesubsection}},
}

%%% 链接设置 %%%
\hypersetup{
  colorlinks=true,
  linkcolor=亮色,
  % urlcolor=靛青,
  % filecolor=青碧,
}

%%% 代码高亮设置 %%%
\tcbuselibrary{listings}

\lstset{
  frame=shadowbox,
  frameround=tttt,
  framesep=1pt,
  framextopmargin=6pt,
  framexbottommargin=6pt,
  tabsize=4,
  breaklines=true,
  upquote=true,
  captionpos=b,
  basicstyle=\footnotesize,
  backgroundcolor=\color{雪白},
  rulecolor=\color{水蓝},
  identifierstyle=\color{漆黑},
  commentstyle=\itshape\color{墨色},
  stringstyle=\bfseries\color{青碧},
  % 保留关键字
  keywordstyle=[1]\bfseries\color{靛蓝},
  % 新类、新类型、新接口定义
  keywordstyle=[2]\bfseries\color{绿沈},
  % 原始类型
  keywordstyle=[3]\bfseries\color{品红},
  % 模块
  keywordstyle=[4]\bfseries\color{靛蓝},
  % 其他
  keywordstyle=[5]\color{桃红},
  numberstyle=\bfseries\color{漆黑},
}

% typescript语法定义
\lstdefinelanguage{typescript}{
  morekeywords=[1]{const, let, function, if, else, while, do, return, break, async, await, yield},
  morekeywords=[2]{class, interface, extends, type, this, new},
  morekeywords=[3]{Array, Object, Number, NaN, null, undefined, Set, Buffer, string, number, object},
  morekeywords=[4]{module, exports, require, export import, from},
  otherkeywords={=>},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]`,
}
\lstalias{ts}{typescript}

% rust语法定义
\lstdefinelanguage{rust}{
  morekeywords=[1]{const, let, mut, fn, unsafe, while, loop, if, else, \?, return, await, async},
  morekeywords=[1]{as, dyn, Trait, impl, static, for},
  morekeywords=[1]{break, continue, label},
  morekeywords=[2]{trait, type, struct, newtype, enum, Self, self},
  morekeywords=[3]{Vec, String, str, Box, Cell, Arc, Send, Sync, Error, Option, Result},
  morekeywords=[4]{mod, use, crate, pub},
  morekeywords=[5]{println!, dbg!, format!, panic!},
  otherkeywords={::},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[bd]",
}
\lstalias{rs}{rust}

%%% 页眉页脚设置 %%%
\pagestyle{fancy}
\fancyhead[L]{\textcolor{主色}{\leftmark}}
\fancyhead[C]{\textcolor{主色}{第\zhnumber{\thepage}页}}
\fancyhead[R]{\textcolor{主色}{\rightmark}}
\fancyfoot{}
\renewcommand{\headrule}{\color{主色}\hrule width\textwidth}

%%% tcolorbox %%%
\tcbuselibrary{theorems}
\tcbuselibrary{skins}
\tcbsetforeverylayer{enhanced}

%%% 自定义命令 %%%
% 专名号
\providecommand\专名[1]{%
  \CJKunderline{#1}%
}

% 着重号
\providecommand\着重[1]{%
  \CJKunderdot{\heiti{#1}}%
}

% 内联代码，单一颜色
\providecommand\代码[1]{%
  {\ttfamily{\textcolor{次亮色}{#1}}}%
}

%%% 自定义环境 %%%
% 引用
\newenvironment{引用}
{\begin{quote}\kaishu\small}
{\end{quote}}

\tcolorboxenvironment{引用}{
  blanker,
  borderline west={1mm}{0pt}{丁色}
}

% 定理
\newtcbtheorem[number within=section]{定理}{定理}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=青白,
  colframe=青碧,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=青碧}
}{定理}

% 结论
\newtcbtheorem[number within=section]{结论}{结论}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=姜黄,
  colframe=橙色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=橙色}
}{结论}

% 命题
\newtcbtheorem[number within=section]{命题}{命题}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=灰白,
  colframe=苍青,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=苍青}
}{命题}

% 定义
\newtcbtheorem[number within=section]{定义}{定义}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  colback=次主色,
  before upper={\parindent2em},
  colframe=主色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=主色}
}{定义}

% 文本提示框
\newtcolorbox{文本提示框}[1]{
  skin=empty,
  top=0pt,
  bottom=0pt,
  toprule=0pt,
  bottomrule=0pt,
  leftrule=0pt,
  rightrule=0pt,
  borderline west={2pt}{0pt}{#1},
}

% 提示
\newenvironment{提示}
{\begin{文本提示框}{主色}
    \textcolor{主色}{\heiti{提示：}}
}
{\end{文本提示框}}

% 提醒
\newenvironment{提醒}
{\begin{文本提示框}{乙色}
    \textcolor{乙色}{\heiti{提醒：}}
}
{\end{文本提示框}}

% 注意
\newenvironment{注意}
{\begin{文本提示框}{丙色}
    \textcolor{丙色}{\heiti{注意：}}
}
{\end{文本提示框}}