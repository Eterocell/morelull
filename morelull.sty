%
% 个人自用文档样式
%

\ProvidesPackage{morelull}[2023/06/18 v0.4.0]

% 中文标点符号
\RequirePackage{xeCJKfntef}
% 眉首眉脚
\RequirePackage{fancyhdr}
% 颜色支持
\RequirePackage[table]{xcolor}
\RequirePackage{xcolor-material}
% 代码提示
\RequirePackage{listings}
% 版边边距
\RequirePackage[left=2cm, right=2cm, bottom=2cm, headheight=14pt]{geometry}
% 更加现代定理、引用提示
\RequirePackage{tcolorbox}
% 书签
\RequirePackage[open, openlevel=2, atend]{bookmark}
% 链接
\RequirePackage{hyperref}

%% 字体颜色 %%
\colorlet{正文字色}{MaterialGrey900}
\colorlet{主色}{MaterialBlue900}
\colorlet{次主色}{MaterialBlue700}
\colorlet{乙色}{MaterialGreen}
\colorlet{次乙色}{MaterialGreen50}
\colorlet{丙色}{MaterialTeal}
\colorlet{次丙色}{MaterialTeal50}
\colorlet{丁色}{MaterialBlueGrey}
\colorlet{次丁色}{MaterialBlueGrey50}
\colorlet{戊色}{MaterialCyan}
\colorlet{次戊色}{MaterialCyan50}

\colorlet{亮色}{MaterialPink}
\colorlet{次亮色}{MaterialPink200}

%%% CTEX格式设置 %%%
\ctexset{
  today=big,
  contentsname={文章导航},
  section/format=\Large\bfseries\centering\color{主色},
  subsection/number={\textcolor{主色}{\thesubsection}},
}

%%% 链接设置 %%%
\hypersetup{
  colorlinks=true,
  linkcolor=亮色,
  % urlcolor=靛青,
  % filecolor=青碧,
}

%%% 代码高亮设置 %%%
\tcbuselibrary{listings}

\lstset{
  frame=shadowbox,
  frameround=tttt,
  framesep=1pt,
  framextopmargin=6pt,
  framexbottommargin=6pt,
  tabsize=4,
  breaklines=true,
  upquote=true,
  captionpos=b,
  basicstyle=\footnotesize,
  backgroundcolor=\color{MaterialBlue50},
  rulecolor=\color{MaterialBlue},
  identifierstyle=\color{MaterialBlue800},
  commentstyle=\itshape\color{MaterialGreen700},
  stringstyle=\bfseries\color{MaterialAmber800},
  % 保留关键字
  keywordstyle=[1]\bfseries\color{MaterialPurple700},
  % 新类、新类型、新接口定义
  keywordstyle=[2]\bfseries\color{MaterialTeal800},
  % 原始类型
  keywordstyle=[3]\bfseries\color{MaterialPink400},
  % 模块
  keywordstyle=[4]\bfseries\color{MaterialBlue900},
  % 其他
  keywordstyle=[5]\color{MaterialRed500},
  numberstyle=\bfseries\color{MaterialGrey800},
}

% typescript语法定义
\lstdefinelanguage{typescript}{
  morekeywords=[1]{const, let, function, if, else, while, do, return, break, async, await, yield},
  morekeywords=[2]{class, interface, extends, type, this, new},
  morekeywords=[3]{Array, Object, Number, NaN, null, undefined, Set, Buffer, string, number, object},
  morekeywords=[4]{module, exports, require, export import, from},
  otherkeywords={=>},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]`,
}
\lstalias{ts}{typescript}

% rust语法定义
\lstdefinelanguage{rust}{
  morekeywords=[1]{const, let, mut, fn, unsafe, while, loop, if, else, \?, return, await, async},
  morekeywords=[1]{as, dyn, Trait, impl, static, for},
  morekeywords=[1]{break, continue, label},
  morekeywords=[2]{trait, type, struct, newtype, enum, Self, self},
  morekeywords=[3]{Vec, String, str, Box, Cell, Arc, Send, Sync, Error, Option, Result},
  morekeywords=[4]{mod, use, crate, pub},
  morekeywords=[5]{println!, dbg!, format!, panic!},
  otherkeywords={::},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[bd]",
}
\lstalias{rs}{rust}

%%% 页眉页脚设置 %%%
\pagestyle{fancy}
\fancyhead[L]{\textcolor{主色}{\leftmark}}
\fancyhead[C]{\textcolor{主色}{第\zhnumber{\thepage}页}}
\fancyhead[R]{\textcolor{主色}{\rightmark}}
\fancyfoot{}
\renewcommand{\headrule}{\color{主色}\hrule width\textwidth}

%%% tcolorbox %%%
\tcbuselibrary{theorems}
\tcbuselibrary{skins}
\tcbsetforeverylayer{enhanced}

%%% 自定义命令 %%%
% 专名号
\providecommand\专名[1]{%
  \CJKunderline{#1}%
}

% 着重号
\providecommand\着重[1]{%
  \CJKunderdot{\heiti{#1}}%
}

% 内联代码，单一颜色
\providecommand\代码[1]{%
  {\ttfamily{\textcolor{次亮色}{#1}}}%
}

%%% 自定义环境 %%%
% 引用
\newenvironment{引用}
{\begin{quote}\kaishu\small}
{\end{quote}}

\tcolorboxenvironment{引用}{
  blanker,
  borderline west={1mm}{0pt}{丁色}
}

% 定理
\newtcbtheorem[number within=section]{定理}{定理}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=次乙色,
  colframe=乙色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=乙色}
}{定理}

% 结论
\newtcbtheorem[number within=section]{结论}{结论}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=次丙色,
  colframe=丙色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=丙色}
}{结论}

% 命题
\newtcbtheorem[number within=section]{命题}{命题}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=次丁色,
  colframe=丁色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=丁色}
}{命题}

% 定义
\newtcbtheorem[number within=section]{定义}{定义}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  colback=次戊色,
  before upper={\parindent2em},
  colframe=戊色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=戊色}
}{定义}

% 文本提示框
\newtcolorbox{文本提示框}[1]{
  skin=empty,
  top=0pt,
  bottom=0pt,
  toprule=0pt,
  bottomrule=0pt,
  leftrule=0pt,
  rightrule=0pt,
  borderline west={2pt}{0pt}{#1},
}

% 提示
\newenvironment{提示}
{\begin{文本提示框}{主色}
    \textcolor{主色}{\heiti{提示：}}
}
{\end{文本提示框}}

% 提醒
\newenvironment{提醒}
{\begin{文本提示框}{乙色}
    \textcolor{乙色}{\heiti{提醒：}}
}
{\end{文本提示框}}

% 注意
\newenvironment{注意}
{\begin{文本提示框}{丙色}
    \textcolor{丙色}{\heiti{注意：}}
}
{\end{文本提示框}}