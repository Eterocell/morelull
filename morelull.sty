%
% 个人自用文档样式
%

\ProvidesPackage{morelull}[2023/07/01 v0.4.0]

% 中文标点符号
\RequirePackage{xeCJKfntef}
% 眉首眉脚
\RequirePackage{fancyhdr}
% 颜色支持
\RequirePackage[table]{xcolor}
% 代码提示
\RequirePackage{listings}
% 版边边距
\RequirePackage[left=2cm, right=2cm, bottom=2cm, headheight=14pt]{geometry}
% 更加现代定理、引用提示
\RequirePackage{tcolorbox}
% 书签
\RequirePackage[open, openlevel=2, atend]{bookmark}
% 链接
\RequirePackage{hyperref}

%% 字体颜色 %%
\providecolor{牛角灰}{HTML}{2d2e36}
\providecolor{虹蓝}{HTML}{2177b8}
\providecolor{品红}{HTML}{ef3473}
\providecolor{瀑布蓝}{HTML}{51c4d3}
\providecolor{麦苗绿}{HTML}{55bb8a}
\providecolor{嫩菊绿}{HTML}{f0f5e5}
\providecolor{金驼}{HTML}{e46828}
\providecolor{狼烟灰}{HTML}{5d655f}
\providecolor{胆矾蓝}{HTML}{0f95b0}
\providecolor{海天蓝}{HTML}{c6e6e8}
\providecolor{珍珠灰}{HTML}{e4dfd7}
\providecolor{橄榄黄绿}{HTML}{bec936}
\providecolor{海沬绿}{HTML}{e2e7bf}

% 代码高亮
\providecolor{魏紫}{HTML}{7e1671}
\providecolor{青莲}{HTML}{8b2671}
\providecolor{海王绿}{HTML}{248067}
\providecolor{玉鈫蓝}{HTML}{126e82}

\colorlet{正文字色}{牛角灰}
\colorlet{主色}{虹蓝}

\colorlet{提示色}{虹蓝}
\colorlet{提醒色}{麦苗绿}
\colorlet{注意色}{金驼}
\colorlet{引用色}{狼烟灰}

\colorlet{定理色}{麦苗绿}
\colorlet{定理布色}{嫩菊绿}
\colorlet{结论色}{胆矾蓝}
\colorlet{结论布色}{海天蓝}
\colorlet{命题色}{狼烟灰}
\colorlet{命题布色}{珍珠灰}
\colorlet{定义色}{橄榄黄绿}
\colorlet{定义布色}{海沬绿}



%%% CTEX格式设置 %%%
\ctexset{
  today=big,
  contentsname={文章导航},
  section/format=\Large\bfseries\centering\color{主色},
  subsection/number={\textcolor{主色}{\thesubsection}},
}

%%% 链接设置 %%%
\hypersetup{
  colorlinks=true,
  linkcolor=品红,
  % urlcolor=靛青,
  % filecolor=青碧,
}

%%% 代码高亮设置 %%%
\tcbuselibrary{listings}

\lstset{
  frame=shadowbox,
  framesep=1pt,
  framextopmargin=6pt,
  framexbottommargin=6pt,
  framexleftmargin=6pt,
  tabsize=4,
  breaklines=true,
  upquote=true,
  captionpos=b,
  basicstyle=\footnotesize,
  rulecolor=\color{主色},
  rulesepcolor=\color{主色},
  identifierstyle=\color{主色},
  commentstyle=\itshape\color{狼烟灰},
  stringstyle=\bfseries\color{魏紫},
  % 保留关键字
  keywordstyle=[1]\bfseries\color{品红},
  % 新类、新类型、新接口定义
  keywordstyle=[2]\bfseries\color{青莲},
  % 原始类型
  keywordstyle=[3]\bfseries\color{海王绿},
  % 模块
  keywordstyle=[4]\bfseries\color{玉鈫蓝},
  % 其他
  keywordstyle=[5]\color{主色},
  numberstyle=\bfseries\color{主色},
}

% typescript语法定义
\lstdefinelanguage{typescript}{
  morekeywords=[1]{const, let, function, if, else, while, do, return, break, async, await, yield, static, get, set},
  morekeywords=[2]{class, interface, extends, type, this, new},
  morekeywords=[3]{Array, Object, Number, NaN, null, undefined, Set, Buffer, string, number, object},
  morekeywords=[4]{module, exports, require, export import, from},
  otherkeywords={=>},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]`,
}
\lstalias{ts}{typescript}

% rust语法定义
\lstdefinelanguage{rust}{
  morekeywords=[1]{const, let, mut, fn, unsafe, while, loop, if, else, \?, return, await, async},
  morekeywords=[1]{as, dyn, Trait, impl, static, for},
  morekeywords=[1]{break, continue, label},
  morekeywords=[2]{trait, type, struct, newtype, enum, Self, self},
  morekeywords=[3]{Vec, String, str, Box, Cell, Arc, Send, Sync, Error, Option, Result},
  morekeywords=[4]{mod, use, crate, pub},
  morekeywords=[5]{println!, dbg!, format!, panic!},
  otherkeywords={::},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[bd]",
}
\lstalias{rs}{rust}

% racket语法定义
\lstdefinelanguage{racket}{
  morekeywords=[1]{define, values, define-values let, match-define, if, when, unless, ->, ->>, maybe/do, monad/do, >->, <-},
  morekeywords=[1]{define/contract, define/curry/contract/, define/match1, define/match1/contract, define/curry, for/array, for/hashmap},
  morekeywords=[2]{it, break},
  morekeywords=[3]{Maybe, Just, Nothing, nothing, Array, Map, string},
  morekeywords=[4]{require, provide, module},
  morekeywords=[5]{>->},
  morecomment=[l]{;},
  morestring=[bd]{"},
}
\lstalias{rkt}{racket}

%%% 页眉页脚设置 %%%
\pagestyle{fancy}
\fancyhead[L]{\textcolor{主色}{\leftmark}}
\fancyhead[C]{\textcolor{主色}{第\zhnumber{\thepage}页}}
\fancyhead[R]{\textcolor{主色}{\rightmark}}
\fancyfoot{}
\renewcommand{\headrule}{\color{主色}\hrule width\textwidth}

%%% tcolorbox %%%
\tcbuselibrary{theorems}
\tcbuselibrary{skins}
\tcbsetforeverylayer{enhanced}

%%% 自定义命令 %%%
% 专名号
\providecommand\专名[1]{%
  \CJKunderline{#1}%
}

% 着重号
\providecommand\着重[1]{%
  \CJKunderdot{\heiti{#1}}%
}

% 内联代码，单一颜色
\providecommand\代码[1]{%
  {\ttfamily{\textcolor{瀑布蓝}{#1}}}%
}

%%% 自定义环境 %%%
% 引用
\newenvironment{引用}
{\begin{quote}\kaishu\small}
{\end{quote}}

\tcolorboxenvironment{引用}{
  blanker,
  borderline west={1mm}{0pt}{引用色}
}

% 定理
\newtcbtheorem[number within=section]{定理}{定理}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=定理布色,
  colframe=定理色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=定理色}
}{定理}

% 结论
\newtcbtheorem[number within=section]{结论}{结论}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=结论布色,
  colframe=结论色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=结论色}
}{结论}

% 命题
\newtcbtheorem[number within=section]{命题}{命题}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  before upper={\parindent2em},
  colback=命题布色,
  colframe=命题色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=命题色}
}{命题}

% 定义
\newtcbtheorem[number within=section]{定义}{定义}{
  fonttitle=\heiti,
  boxrule=0.1mm,
  colback=定义布色,
  before upper={\parindent2em},
  colframe=定义色,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=定义色}
}{定义}

% 文本提示框
\newtcolorbox{文本提示框}[1]{
  skin=empty,
  top=0pt,
  bottom=0pt,
  toprule=0pt,
  bottomrule=0pt,
  leftrule=0pt,
  rightrule=0pt,
  borderline west={2pt}{0pt}{#1},
}

% 提示
\newenvironment{提示}
{\begin{文本提示框}{提示色}
    \textcolor{提示色}{\heiti{提示：}}
}
{\end{文本提示框}}

% 提醒
\newenvironment{提醒}
{\begin{文本提示框}{提醒色}
    \textcolor{提醒色}{\heiti{提醒：}}
}
{\end{文本提示框}}

% 注意
\newenvironment{注意}
{\begin{文本提示框}{注意色}
    \textcolor{注意色}{\heiti{注意：}}
}
{\end{文本提示框}}